<!DOCTYPE HTML>
<!--
	Dimension by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Le Petit Juriste</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
		<div id="wrapper">

			<!-- Header -->
			<header id="header">
				<div class="logo">
					<span class="icon fa-gem"></span>
				</div>
				<div class="content">
					<div class="inner">
						<h1>Le Petit Juriste</h1>
						<p>Livres de droit en version numérique à prix vraiment abordable<br>pour les étudiants malgasy qui ont du mal avec les livres chers !</p>
					</div>
				</div>
				<nav>
					<ul>
						<li><a href="#intro">Intro</a></li>
						<li><a href="#work">Livres</a></li>
						<li><a href="#about">À propos</a></li>
					</ul>
				</nav>
			</header>

			<!-- Main -->
			<div id="main">

				<!-- Intro -->
				<article id="intro">
					<h2 class="major">Bienvenue !</h2>
					<span class="image main"><img src="images/pic01.jpg" alt="" /></span>
					<p>Ici, tu trouves des guides de droit clairs, concis et mis à jour, en PDF, à des prix étudiants (5000 à 15000 Ar max). Faits par un jeune juriste malgache pour aider les étudiants comme toi.</p>
					<p>Pas de gros manuels à 100 000 Ar – que du contenu utile et direct !</p>
				</article>

				<!-- Work (Livres) -->
				<article id="work">
					<h2 class="major">Mes livres</h2>
					<span class="image main"><img src="images/pic02.jpg" alt="" /></span>
					<div id="livres-container">Chargement des livres...</div>
				</article>

				<!-- About -->
				<article id="about">
					<h2 class="major">À propos</h2>
					<span class="image main"><img src="images/pic03.jpg" alt="" /></span>
					<p>Je suis Steven, passionné de droit et étudiant/jeune professionnel à Tana. J'ai créé ces ebooks parce que je sais à quel point les livres de droit classiques sont chers et pas toujours adaptés au contexte malgache.</p>
					<p>Tous les livres sont en version numérique uniquement (PDF), faciles à lire sur téléphone ou ordi. Paiement via Mobile Money / Orange Money / Airtel Money / ou banque, et livraison immédiate par Messenger/email.</p>
					<p>Pour acheter : clique "Acheter" → envoie-moi un message sur Messenger avec le titre du livre.</p>
				</article>

			</div>

			<!-- Footer -->
			<footer id="footer">
				<p class="copyright">&copy; Le Petit Juriste 2026. Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
			</footer>

		</div>

		<!-- BG -->
		<div id="bg"></div>

		<!-- Scripts -->
		<script src="assets/js/jquery.min.js"></script>
		<script src="assets/js/browser.min.js"></script>
		<script src="assets/js/breakpoints.min.js"></script>
		<script src="assets/js/util.js"></script>
		<script src="assets/js/main.js"></script>

		<!-- Loader Decap CMS + affichage -->
		<script>
			// Liste des slugs (noms sans .json) – AJOUTE ICI À CHAQUE FOIS QUE TU CRÉES UN LIVRE DANS /admin
			const livreSlugs = [
				// "introduction-au-droit-civil-malgache",
				// "droit-des-obligations-simplifie",
				// Ajoute les nouveaux slugs ici (regarde dans data/livres/ sur GitHub après création dans Decap)
			];

			async function loadAndDisplayLivres() {
				const container = document.getElementById('livres-container');
				container.innerHTML = '<p>Chargement des livres...</p>';

				const baseUrl = 'https://raw.githubusercontent.com/ssstew368-coder/LePetitJuriste/main/data/livres/';
				const livres = [];

				for (const slug of livreSlugs) {
					try {
						const res = await fetch(`${baseUrl}${slug}.json`);
						if (res.ok) {
							const livre = await res.json();
							livres.push(livre);
						}
					} catch (err) {
						console.error('Erreur sur', slug, err);
					}
				}

				if (livres.length === 0) {
					container.innerHTML = '<p>Aucun livre pour le moment. Ajoute-en via /admin !</p>';
					return;
				}

				// Grouper par catégorie
				const categories = {};
				livres.forEach(livre => {
					const cat = livre.categorie || 'Autres';
					if (!categories[cat]) categories[cat] = [];
					categories[cat].push(livre);
				});

				container.innerHTML = '';
				Object.keys(categories).forEach(cat => {
					const catDiv = document.createElement('div');
					catDiv.innerHTML = `<h3 class="major">${cat}</h3>`;

					const ul = document.createElement('ul');
					ul.className = 'alt'; // style liste du template

					categories[cat].forEach(livre => {
						const li = document.createElement('li');
						li.style = 'display:flex; align-items:flex-start; margin-bottom:1em; cursor:pointer;';
						li.innerHTML = `
							<img src="${livre.image}" alt="${livre.titre}" style="width:80px; height:auto; margin-right:1em; border-radius:4px;" />
							<div>
								<h4 style="margin:0;">${livre.titre}</h4>
								<p style="margin:0.2em 0; font-size:0.9em;">${livre.desc_courte}</p>
								<span style="color:#3fb950; font-weight:bold;">${livre.prix}</span>
								<br>
								<a href="https://www.facebook.com/messages/t/61586967921714" target="_blank" class="button small" style="margin-top:0.5em;">Acheter</a>
							</div>
						`;

						// Modal sur clic (simple overlay)
						li.addEventListener('click', e => {
							if (e.target.tagName !== 'A') {
								const modal = document.createElement('div');
								modal.style = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:100;display:flex;align-items:center;justify-content:center;';
								modal.innerHTML = `
									<div style="background:#0d1117;padding:2em;max-width:80%;border-radius:8px;position:relative;color:#c9d1d9;">
										<span style="position:absolute;top:1em;right:1em;cursor:pointer;font-size:2em;" onclick="this.parentElement.parentElement.remove();">×</span>
										<h2>${livre.titre}</h2>
										<p>${livre.desc_longue.replace(/\n/g, '<br>')}</p>
										<p><strong>${livre.prix}</strong></p>
										${(livre.extraits || []).map(src => `<img src="${src}" style="max-width:100%;margin:1em 0;" alt="Extrait">`).join('')}
										<br>
										<a href="https://www.facebook.com/messages/t/61586967921714" target="_blank" class="button">Acheter via Messenger</a>
									</div>
								`;
								document.body.appendChild(modal);
							}
						});

						ul.appendChild(li);
					});

					catDiv.appendChild(ul);
					container.appendChild(catDiv);
				});
			}

			// Lance au chargement
			window.addEventListener('load', loadAndDisplayLivres);
		</script>

	</body>
</html>